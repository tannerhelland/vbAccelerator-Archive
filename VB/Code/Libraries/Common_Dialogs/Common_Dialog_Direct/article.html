<html lang="en" >

<!-- Mirrored from www.vbaccelerator.com/home/VB/Code/Libraries/Common_Dialogs/Common_Dialog_Direct/article.asp by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Jun 2015 20:47:33 GMT -->
<head>

<title>vbAccelerator - CommonDialog/Direct</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="
Common Dialog/Direct is a new DLL or class library which shows how to completely replace 
COMDLG32.OCX through Visual Basic code. The main advantage of this is you no longer need 
to put a control on a form to use common dialogs - just declare an instance of the class and 
you have a straight replacement. You can also incorporate the Common Dialog/Direct code 
straight into your own project if you want to reduce dependency files when you 
ship your project.
" /><link rel="stylesheet" href="../../../../../res/screen.css" media="SCREEN" /><link rel="stylesheet" href="../../../../../res/print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000.html";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="../../../../../../../pagead2.googlesyndication.com/pagead/f.txt">
</script>
</p>
</td>
<td></td>
</tr></tr><tr class="navbar"><td><a href="http://www.vbaccelerator.com/home/index.asp"><img width="125" height="25" src="../../../../../res/vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="http://www.vbaccelerator.com/home/index.asp">Home</a>&#160;.&#160;<a href="../../../../index.html">VB</a>&#160;.&#160;<a href="../../../index.html">Code</a>&#160;.&#160;<a href="../../index.html">Libraries</a>&#160;.&#160;<a href="../index.html">Common Dialogs</a>&#160;.&#160;CommonDialog/Direct</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="../../../../../res/download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="VB5_Common_Dialog_Direct_Binary.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB5 Common Dialog Direct Binary</a> (32K)</p><p class="nav"><a href="VB5_Common_Dialog_Direct_Demonstration.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB5 Common Dialog Direct Demonstration</a> (19K)</p><p class="nav"><a href="VB5_Common_Dialog_Direct_Full_Source.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB5 Common Dialog Direct Full Source</a> (73K)</p><p /><p class="nav"><a href="VB6_Common_Dialog_Direct_Binary.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB6 Common Dialog Direct Binary</a> (32K)</p><p class="nav"><a href="VB6_Common_Dialog_Direct_Demonstration.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB6 Common Dialog Direct Demonstration</a> (14K)</p><p class="nav"><a href="VB6_Common_Dialog_Direct_Full_Source.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB6 Common Dialog Direct Full Source</a> (70K)</p><br /><br /><img src="../../../../../res/information.png" width="125" height="21" alt="Information" /><p class="nav">Article:1419</p><p class="nav">&#160;&#160;<a href="http://www.vbaccelerator.com/linkto.asp?id=1419&amp;type=Article&amp;title=CommonDialog%2FDirect">Link to this page</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="../../../../../res/bugTrak.png" width="125" height="21" alt="BugTrak System" />﻿<p class="nav"><a href="bugTrak.html">BugTrak</a></p><p class="nav"><a href="bugTrak.html#bugs"><img src="../../../../../res/btBug.png" width="16" height="16" alt="Bug" />&#160;Bugs:</a> 3 / 4</p><p class="nav"><a href="bugTrak.html#issues"><img src="../../../../../res/btIssue.png" width="16" height="16" alt="Issue" />&#160;Issues:</a> 2 / 3</p><p class="nav"><a href="bugTrak.html#questions"><img src="../../../../../res/btQuestion.png" width="16" height="16" alt="Question" />&#160;Questions:</a> 0 / 0</a></p><p class="nav">Updated:8 December 2003</p>
<br /><br /><img src="../../../../../res/updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="../../../../../res/update.png" width="8" height="8" alt="Update" />20 Jun 2003<br /><p class="update">Hook support now enabled for Print Dialogs.  The prior code did not
work as the structure was incorrectly aligned.  The new version fixes this problem.  Many
thanks to Uwe Wiemer and Klaus Probst for identifying the fix.
        </p><p class="update">Added a properties to return the selected Printer device name, driver
name and port.</p></p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="../../../../../res/related.png" width="125" height="21" alt="Related Items" />﻿<br /><br /><img src="../../../../../res/search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="http://www.google.com/search"><img src="../../../../../../../www.google.com/logos/Logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="http://www.vbaccelerator.com/home/The_Site/NewSite/article.asp"><img src="../../../../../res/newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>CommonDialog/Direct</h1><p class="splash">Take control over all the Windows Common Dialogs with this component</p><img src="commonDialog.png" width="280" height="208" alt="Common Dialog/Direct in Action" /><p /><p>
Common Dialog/Direct is a new DLL or class library which shows how to completely replace 
COMDLG32.OCX through Visual Basic code. The main advantage of this is you no longer need 
to put a control on a form to use common dialogs - just declare an instance of the class and 
you have a straight replacement. You can also incorporate the Common Dialog/Direct code 
straight into your own project if you want to reduce dependency files when you 
ship your project.
</p>
This library is based on articles in MSDN and the VB library provided by Bruce McKinney in his excellent book Hardcore Visual Basic. It expands on both sources - the Hardcore VB library isn't a drop in replacement for the VB version, it has a completely new interface, whilst the main MSDN version was somewhat bug-ridden. 

<h2>Features</h2><p>There are a number of areas where Common Dialog/Direct improves upon the implementation 
of COMDLG32.OCX supplied with VB:</p><ul><li>Common Dialog hooks are supported. It is possible to:
<ul><li>Confirm files being chosen before a file dialog is closed</li><li>Centre dialogs accurately to any object</li><li>Incorporate a common dialog into your own form, like the Add Form and New Project 
dialogs in VB5.</li><li>Templates are supported.</li></ul></li><li>The file dialogs return the selected filter index when the user chooses a file.</li><li>You can get and set the custom colours set up in the colour dialog.</li><li>It is possible to show the Page Setup dialog for the printer.</li></ul><p>Here is a sample of how to use Common Dialog/Direct:</p><pre>
    Dim c As New cCommonDialog 
    With c 
        .DialogTitle = "Choose Text FIle" 
        .CancelError = True 
        .hWnd = Me.hWnd 
        .flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST 
        .InitDir = "C:\STEVEMAC" 
        .Filter = "Internet documents (*.HTM)|*.HTM|Text files (*.TXT)|*.TXT|All Files (*.*)|*.*" 
        .FilterIndex = 1 
        .ShowOpen 
        
        txtFileName = .filename 
        txtFilter = .Filter 
        txtContents = GetFileText(.filename) 
        
    End With 
</pre><p>The sample code in the download exercises all the different dialogs.</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center"></p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="http://www.vbaccelerator.com/home/index.asp"><img width="125" height="25" src="../../../../../res/vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="http://www.vbaccelerator.com/home/index.asp">Home</a>&#160;.&#160;<a href="../../../../index.html">VB</a>&#160;.&#160;<a href="../../../index.html">Code</a>&#160;.&#160;<a href="../../index.html">Libraries</a>&#160;.&#160;<a href="../index.html">Common Dialogs</a>&#160;.&#160;CommonDialog/Direct</p><br /><p class="nav"><a href="http://www.vbaccelerator.com/home/The_Site/Copyright/article.asp">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 22 June 2003</p></td><td></td></tr></table>
</body>
<!-- Mirrored from www.vbaccelerator.com/home/VB/Code/Libraries/Common_Dialogs/Common_Dialog_Direct/article.asp by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Jun 2015 20:47:35 GMT -->
</html>
