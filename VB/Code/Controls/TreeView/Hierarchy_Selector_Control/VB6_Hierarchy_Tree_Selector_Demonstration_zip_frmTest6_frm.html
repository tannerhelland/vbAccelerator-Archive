<html lang="en" >

<!-- Mirrored from www.vbaccelerator.com/home/VB/Code/Controls/TreeView/Hierarchy_Selector_Control/VB6_Hierarchy_Tree_Selector_Demonstration_zip_frmTest6_frm.asp by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Jun 2015 21:30:14 GMT -->
<head>
<title>vbAccelerator - Contents of code file: frmTest6.frm</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: frmTest6.frm" /><link rel="stylesheet" href="../../../../../res/screen.css" media="SCREEN" /><link rel="stylesheet" href="../../../../../res/print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000.html";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="../../../../../../../pagead2.googlesyndication.com/pagead/f.txt">
</script>
</p>
</td>
<td></td>
</tr></tr><tr class="navbar"><td><a href="http://www.vbaccelerator.com/home/index.asp"><img width="125" height="25" src="../../../../../res/vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="http://www.vbaccelerator.com/home/index.asp">Home</a>&#160;.&#160;<a href="../../../../index.html">VB</a>&#160;.&#160;<a href="../../../index.html">Code</a>&#160;.&#160;<a href="../../index.html">Controls</a>&#160;.&#160;<a href="../index.html">TreeView</a>&#160;.&#160;<a href="article.html">Hierarchy Selector Control </a>&#160;.&#160;<a href="VB6_Hierarchy_Tree_Selector_Demonstration.html">VB6 Hierarchy Tree Selector Demonstration</a>&#160;.&#160;frmTest6.frm</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="../../../../../res/download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="VB5_Hierarchy_Tree_Selector_Control.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB5 Hierarchy Tree Selector Control</a> (40K)</p><p class="nav"><a href="VB5_Hierarchy_Tree_Selector_Demonstration.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB5 Hierarchy Tree Selector Demonstration</a> (16K)</p><p class="nav"><a href="VB5_Hierarchy_Tree_Selector_Full_Source.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB5 Hierarchy Tree Selector Full Source</a> (75K)</p><p /><p class="nav"><a href="VB6_Hierarchy_Tree_Selector_Control.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB6 Hierarchy Tree Selector Control</a> (39K)</p><p class="nav"><a href="VB6_Hierarchy_Tree_Selector_Demonstration.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB6 Hierarchy Tree Selector Demonstration</a> (15K)</p><p class="nav"><a href="VB6_Hierarchy_Tree_Selector_Full_Source.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB6 Hierarchy Tree Selector Full Source</a> (74K)</p><br /><br /><img src="../../../../../res/information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:11777</p><p class="nav">&#160;&#160;<a href="http://www.vbaccelerator.com/linkto.asp?id=11777&amp;type=Zip&amp;title=VB6%20Hierarchy%20Tree%20Selector%20Demonstration%2Ezip%5FfrmTest6">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="../../../../../res/bugTrak.png" width="125" height="21" alt="BugTrak System" />﻿<p class="nav"><a href="bugTrak.html">BugTrak</a></p><p class="nav"><a href="bugTrak.html#bugs"><img src="../../../../../res/btBug.png" width="16" height="16" alt="Bug" />&#160;Bugs:</a> 0 / 1</p><p class="nav"><a href="bugTrak.html#issues"><img src="../../../../../res/btIssue.png" width="16" height="16" alt="Issue" />&#160;Issues:</a> 0 / 0</p><p class="nav"><a href="bugTrak.html#questions"><img src="../../../../../res/btQuestion.png" width="16" height="16" alt="Question" />&#160;Questions:</a> 0 / 0</a></p><p class="nav">Updated:16 November 2003</p>
<br /><br /><img src="../../../../../res/updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="../../../../../res/update.png" width="8" height="8" alt="Update" />25 Aug 1999<br /><p class="update">Version 2 of the control adds the following:</p><p class="update">Tile a picture into the TreeView background. This code is based on Ben Baird's 
TreeView background image sample. Visit his great website, 
<a href="http://vbthunder.com/">VB Thunder</a>.</p><p class="update">Get/set item states using the new <i>Value</i> property.</p><p class="update">New <i>Clear</i> method to reset the content.</p></p><br /><br /><img src="../../../../../res/related.png" width="125" height="21" alt="Related Items" />﻿<p class="nav"><img src="../../../../../res/rel.png" width="8" height="8" alt="Related Item" /><a href="http://www.vbaccelerator.com/article.asp?id=17">Subclassing Without The Crashes</a></p><br /><br /><img src="../../../../../res/search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="http://www.google.com/search"><img src="../../../../../../../www.google.com/logos/Logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="http://www.vbaccelerator.com/home/The_Site/NewSite/article.asp"><img src="../../../../../res/newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: frmTest6.frm</h1><pre>VERSION 5.00
Object = "{6B7E6392-850A-101B-AFC0-4210102A8DA7}#1.3#0"; "COMCTL32.OCX"
Object = "{677448D6-C83D-11D2-BEF8-525400DFB47A}#1.0#0"; "cTreeOpt6.ocx"
Begin VB.Form frmTest 
   Caption         =   "Hierarchy Tree Selector Control"
   ClientHeight    =   6630
   ClientLeft      =   4800
   ClientTop       =   1755
   ClientWidth     =   6795
   BeginProperty Font 
      Name            =   "Tahoma"
      Size            =   8.25
      Charset         =   0
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   Icon            =   "frmTest6.frx":0000
   LinkTopic       =   "Form1"
   ScaleHeight     =   6630
   ScaleWidth      =   6795
   Begin VB.CommandButton cmdEval 
      Caption         =   "&amp;Evaluate"
      Height          =   375
      Left            =   5460
      TabIndex        =   10
      Top             =   360
      Width           =   1215
   End
   Begin VB.CommandButton cmdCheckSelected 
      Caption         =   "&amp;Get Selected"
      Height          =   375
      Left            =   5460
      TabIndex        =   9
      Top             =   960
      Width           =   1215
   End
   Begin VB.CommandButton cmdSetSelected 
      Caption         =   "&amp;Set Selected"
      Height          =   375
      Left            =   5460
      TabIndex        =   8
      Top             =   1380
      Width           =   1215
   End
   Begin VB.CheckBox chk3DIcons 
      Appearance      =   0  'Flat
      Caption         =   "Flat &amp;Icons"
      ForeColor       =   &amp;H80000008&amp;
      Height          =   195
      Left            =   2040
      TabIndex        =   7
      Top             =   4020
      Value           =   1  'Checked
      Width           =   1155
   End
   Begin VB.CheckBox chkBackground 
      Appearance      =   0  'Flat
      Caption         =   "&amp;Background"
      ForeColor       =   &amp;H80000008&amp;
      Height          =   195
      Left            =   3360
      TabIndex        =   6
      Top             =   4020
      Width           =   1275
   End
   Begin cTreeOpt6.XTreeOpt XTreeOpt2 
      Height          =   2055
      Left            =   60
      TabIndex        =   5
      Top             =   4500
      Width           =   5295
      _ExtentX        =   9340
      _ExtentY        =   3625
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   -2147483630
      Indentation     =   256.251983642578
   End
   Begin cTreeOpt6.XTreeOpt XTreeOpt1 
      Height          =   3675
      Left            =   60
      TabIndex        =   4
      Top             =   300
      Width           =   5295
      _ExtentX        =   9340
      _ExtentY        =   6482
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   -2147483630
      Indentation     =   256.251983642578
   End
   Begin VB.CheckBox chkLocked 
      Caption         =   "&amp;Locked"
      Height          =   195
      Left            =   1200
      TabIndex        =   3
      Top             =   4020
      Width           =   2715
   End
   Begin VB.CheckBox chkEnabled 
      Caption         =   "E&amp;nabled"
      Height          =   195
      Left            =   60
      TabIndex        =   2
      Top             =   4020
      Value           =   1  'Checked
      Width           =   1095
   End
   Begin VB.Image imgBack 
      Height          =   1920
      Left            =   4980
      Picture         =   "frmTest6.frx":014A
      Top             =   2040
      Visible         =   0   'False
      Width           =   1920
   End
   Begin VB.Label lblHierarchy 
      Caption         =   "Hierarchy Tree:"
      Height          =   255
      Left            =   60
      TabIndex        =   1
      Top             =   4260
      Width           =   5235
   End
   Begin VB.Label lblOption 
      Caption         =   "Option Tree:"
      Height          =   195
      Left            =   60
      TabIndex        =   0
      Top             =   60
      Width           =   5175
   End
   Begin ComctlLib.ImageList ilsIcons 
      Left            =   5460
      Top             =   6000
      _ExtentX        =   1005
      _ExtentY        =   1005
      BackColor       =   -2147483643
      ImageWidth      =   16
      ImageHeight     =   16
      MaskColor       =   12632256
      _Version        =   327682
      BeginProperty Images {0713E8C2-850A-101B-AFC0-4210102A8DA7} 
         NumListImages   =   4
         BeginProperty ListImage1 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "frmTest6.frx":09A6
            Key             =   ""
         EndProperty
         BeginProperty ListImage2 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "frmTest6.frx":0CC0
            Key             =   "TTF"
         EndProperty
         BeginProperty ListImage3 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "frmTest6.frx":0FDA
            Key             =   "TTN"
         EndProperty
         BeginProperty ListImage4 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "frmTest6.frx":12F4
            Key             =   "TTP"
         EndProperty
      EndProperty
   End
End
Attribute VB_Name = "frmTest"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

'
' ====================================================================
' Filename: frmTest.ctl
' Author:   SP McMahon
' Date:     15 June 1999
'
' Tester for the vbAccelerator Hierarchy Tree Option Control:
' A Control which modifies a VB5 TreeView control to turn it into
' a Explorer Folder Options/IE Advanced Options style picker.
'
'
' --------------------------------------------------------------------
' vbAccelerator - Advanced, Free Source Code:
' http://vbaccelerator.com/
' ====================================================================
'

Private Sub chk3DIcons_Click()
   If chk3DIcons.Value = Checked Then
      XTreeOpt1.IconSet = OptionTreeIconsWin98
   Else
      XTreeOpt1.IconSet = OptionTreeIcons3d
   End If
End Sub

Private Sub chkBackground_Click()
   If (chkBackground.Value = Checked) Then
      XTreeOpt1.BackgroundPicture = imgBack.Picture
   Else
      XTreeOpt1.BackgroundPicture = Nothing
   End If
End Sub

Private Sub chkEnabled_Click()
    XTreeOpt1.Enabled = -1 * chkEnabled.Value
    If (chkEnabled.Value = Checked) Then
        XTreeOpt1.BackColor = vbWindowBackground
    Else
        XTreeOpt1.BackColor = vbButtonFace
    End If
End Sub

Private Sub chkLocked_Click()
   XTreeOpt1.Locked = (chkLocked.Value = Checked)
End Sub


Private Sub RecurseShowNodes( _
      ByRef nodX As Node, _
      ByRef sMsg As String, _
      ByVal iLevel As Long _
   )
Dim i As Long
Dim nodY As Node
Dim nodZ As Node
Dim iCHildren As Long
Dim bEnd As Boolean

   iCHildren = nodX.Children
   If (iCHildren &gt; 0) Then
      If XTreeOpt1.FolderType(nodX.Index) = OptionTreeCheck Then
         sMsg = sMsg &amp; Space$(iLevel) &amp; "Folder Node: '" &amp; nodX.Text &amp; "',
          Selected: " &amp; (XTreeOpt1.Value(nodX.Index) = OptionTreeCheckFull) &amp;
          vbCrLf
      Else
         sMsg = sMsg &amp; Space$(iLevel) &amp; "Folder Node: '" &amp; nodX.Text &amp; "'" &amp;
          vbCrLf
      End If
      Set nodY = nodX.Child
      iLevel = iLevel + 4
      Do
         bEnd = False
         Set nodZ = nodY
         RecurseShowNodes nodZ, sMsg, iLevel
         If Not (nodY.Next Is Nothing) Then
            Set nodY = nodY.Next
         Else
            bEnd = True
         End If
      Loop While Not (bEnd)
   Else
      If (InStr(nodX.Image, "OPTION") &lt;&gt; 0) Then
         sMsg = sMsg &amp; Space$(iLevel) &amp; "Bottom Option Node: '" &amp; nodX.Text &amp;
          "', Selected: " &amp; (XTreeOpt1.Value(nodX.Index) = OptionTreeCheckFull)
          &amp; vbCrLf
      Else
         sMsg = sMsg &amp; Space$(iLevel) &amp; "Bottom Check Node: '" &amp; nodX.Text &amp;
          "', Selected: " &amp; (XTreeOpt1.Value(nodX.Index) = OptionTreeCheckFull)
          &amp; vbCrLf
      End If
   End If

End Sub

Private Sub cmdCheckSelected_Click()
Dim nod As Node
   With XTreeOpt1
      Select Case .Value(.SelectedNode.Index)
      Case OptionTreeCheckFull
         MsgBox "Selected", vbInformation
      Case OptionTreeCheckNone
         MsgBox "Not Selected", vbInformation
      Case OptionTreeCheckPartial
         MsgBox "Folder: some selected items", vbInformation
      End Select
   End With
End Sub

Private Sub cmdEval_Click()
Dim sMsg As String
Dim iLevel As Long
   RecurseShowNodes XTreeOpt1.Nodes(1), sMsg, iLevel
   MsgBox sMsg, vbInformation
End Sub

Private Sub cmdSetSelected_Click()
   With XTreeOpt1
      If .Value(.SelectedNode.Index) = OptionTreeCheckFull Then
         .Value(.SelectedNode.Index) = OptionTreeCheckNone
      Else
         .Value(.SelectedNode.Index) = OptionTreeCheckFull
      End If
   End With
End Sub

Private Sub Form_Load()
Dim nodX As Object, nodTOp As Object, nodY As ComctlLib.Node
    
    With XTreeOpt1
        .AddFolderType ilsIcons.ListImages(1).Picture, , "STEVE"
        Set nodTOp = .AddFolder(, , "Options", , , True)
        .AddCheck "TRYOUT", nodTOp, "Custom Icons", OptionTreeCheckNone
        .AddCheck , nodTOp, "Fast Start Mode"
        .AddCheck , nodTOp, "Start at your home page"
        Set nodX = .AddFolder(, nodTOp, "Image Size", optiontreeFolderCustom,
         "STEVE", True)
        .AddOption , nodX, "Small (16x16)"
        .AddOption , nodX, "Medium (32x32)"
        .AddOption , nodX, "Large (48x48)"
        Set nodX = .AddFolder(, nodTOp, "Security", OptionTreeCheck, , True)
        .AddCheck , nodX, "Encrypt Files with Password"
        .AddCheck , nodX, "Ask for Password at Startup"
        Set nodY = .AddCheck(, nodX, "SSI Options")
        .AddCheck , nodY, "SSI1.0"
        .AddCheck , nodY, "SSI2.0"
        .AddCheck , nodY, "SSI3.0"
        .AddCheck , nodX, "Warn when Changing zones"
        Set nodX = .AddFolder(, nodTOp, "Toolbars", OptionTreeCheck, , True)
        .AddCheck , nodX, "Main Toolbar"
        .AddCheck , nodX, "Fonts"
        .AddCheck , nodX, "Address"
        Set nodX = .AddFolder(, nodTOp, "Save Settings on Exit",
         optiontreeFolderCustom, "STEVE", True)
        .AddOption , nodX, "Yes"
        .AddOption , nodX, "No"
        .ExpandAll
        .Nodes(1).EnsureVisible
    End With
    With XTreeOpt2
        .AddCheck "SEC", , "All Sectors", , True
        .AddCheck "AAP", .Nodes("SEC"), "Autos and Auto Parts"
        .AddCheck "AUT", .Nodes("AAP"), "Auto Manufacturers"
        .AddCheck "AUP", .Nodes("AAP"), "Auto Parts"
        .AddCheck "TYR", .Nodes("AAP"), "Tires"
        .AddCheck "BNK", .Nodes("SEC"), "Banking"
        .AddCheck "CMB", .Nodes("BNK"), "Commercial Banks"
        .AddCheck "MMB", .Nodes("BNK"), "Merchant Banks"
        .AddCheck "DVB", .Nodes("BNK"), "Derivatives"
        .ExpandAll
    End With
End Sub

Private Sub XTreeOpt1_CheckClick(ItemNode As ComctlLib.Node, Value As
 cTreeOpt6.OptionTreeCheckTypes)
    Debug.Print ItemNode.Text, Value
    If (ItemNode.Key = "TRYOUT") Then
        If (Value = OptionTreeCheckFull) Then
            With XTreeOpt1
                ilsIcons.ListImages.Add , "T1",
                 .CheckPicture(OptionTreeCheckFull)
                ilsIcons.ListImages.Add , "T2",
                 .CheckPicture(OptionTreeCheckNone)
                ilsIcons.ListImages.Add , "T3",
                 .CheckPicture(OptionTreeCheckPartial)
                
                Set .CheckPicture(OptionTreeCheckFull) =
                 ilsIcons.ListImages(2).Picture
                Set .CheckPicture(OptionTreeCheckNone) =
                 ilsIcons.ListImages(3).Picture
                Set .CheckPicture(OptionTreeCheckPartial) =
                 ilsIcons.ListImages(4).Picture
            End With
        Else
            With XTreeOpt1
                Set .CheckPicture(OptionTreeCheckFull) =
                 ilsIcons.ListImages("T1").Picture
                Set .CheckPicture(OptionTreeCheckNone) =
                 ilsIcons.ListImages("T2").Picture
                Set .CheckPicture(OptionTreeCheckPartial) =
                 ilsIcons.ListImages("T3").Picture
                ilsIcons.ListImages.Remove "T1"
                ilsIcons.ListImages.Remove "T2"
                ilsIcons.ListImages.Remove "T3"
            End With
            
        End If
    End If
End Sub

Private Sub XTreeOpt1_OptionClick(ItemNode As ComctlLib.Node)
    MsgBox "Chose Option: " &amp; ItemNode.Text
End Sub


</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center"></p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="http://www.vbaccelerator.com/home/index.asp"><img width="125" height="25" src="../../../../../res/vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="http://www.vbaccelerator.com/home/index.asp">Home</a>&#160;.&#160;<a href="../../../../index.html">VB</a>&#160;.&#160;<a href="../../../index.html">Code</a>&#160;.&#160;<a href="../../index.html">Controls</a>&#160;.&#160;<a href="../index.html">TreeView</a>&#160;.&#160;<a href="article.html">Hierarchy Selector Control </a>&#160;.&#160;<a href="VB6_Hierarchy_Tree_Selector_Demonstration.html">VB6 Hierarchy Tree Selector Demonstration</a>&#160;.&#160;frmTest6.frm</p><br /><p class="nav"><a href="http://www.vbaccelerator.com/home/The_Site/Copyright/article.asp">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 12 April 2003</p></td><td></td></tr></table>
</body>
<!-- Mirrored from www.vbaccelerator.com/home/VB/Code/Controls/TreeView/Hierarchy_Selector_Control/VB6_Hierarchy_Tree_Selector_Demonstration_zip_frmTest6_frm.asp by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Jun 2015 21:30:14 GMT -->
</html>