<html lang="en" >

<!-- Mirrored from www.vbaccelerator.com/home/VB/Code/Controls/Combo_and_List_Boxes/ComboBoxEx/VB6_ComboBoxEx_Demonstration_zip_frmTest_frm.asp by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Jun 2015 21:30:24 GMT -->
<head>
<title>vbAccelerator - Contents of code file: frmTest.frm</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: frmTest.frm" /><link rel="stylesheet" href="../../../../../res/screen.css" media="SCREEN" /><link rel="stylesheet" href="../../../../../res/print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000.html";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="../../../../../../../pagead2.googlesyndication.com/pagead/f.txt">
</script>
</p>
</td>
<td></td>
</tr></tr><tr class="navbar"><td><a href="http://www.vbaccelerator.com/home/index.asp"><img width="125" height="25" src="../../../../../res/vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="http://www.vbaccelerator.com/home/index.asp">Home</a>&#160;.&#160;<a href="../../../../index.html">VB</a>&#160;.&#160;<a href="../../../index.html">Code</a>&#160;.&#160;<a href="../../index.html">Controls</a>&#160;.&#160;<a href="../index.html">Combo and List Boxes</a>&#160;.&#160;<a href="article.html">vbAccelerator ComboBoxEx Control</a>&#160;.&#160;<a href="VB6_ComboBoxEx_Demonstration.html">VB6 ComboBoxEx Demonstration</a>&#160;.&#160;frmTest.frm</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="../../../../../res/download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="VB5_ComboBoxEx_Control.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB5 ComboBoxEx Control</a> (28K)</p><p class="nav"><a href="VB5_ComboBoxEx_Demonstration.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB5 ComboBoxEx Demonstration</a> (38K)</p><p class="nav"><a href="VB5_ComboBoxEx_Full_Source.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB5 ComboBoxEx Full Source</a> (94K)</p><p /><p class="nav"><a href="VB6_ComboBoxEx_Control.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB6 ComboBoxEx Control</a> (28K)</p><p class="nav"><a href="VB6_ComboBoxEx_Demonstration.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB6 ComboBoxEx Demonstration</a> (34K)</p><p class="nav"><a href="VB6_ComboBoxEx_Full_Source.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB6 ComboBoxEx Full Source</a> (91K)</p><br /><br /><img src="../../../../../res/information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:1528</p><p class="nav">&#160;&#160;<a href="http://www.vbaccelerator.com/linkto.asp?id=1528&amp;type=Zip&amp;title=VB6%20ComboBoxEx%20Demonstration%2Ezip%5FfrmTest">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="../../../../../res/bugTrak.png" width="125" height="21" alt="BugTrak System" />﻿<p class="nav"><a href="bugTrak.html">BugTrak</a></p><p class="nav"><a href="bugTrak.html#bugs"><img src="../../../../../res/btBug.png" width="16" height="16" alt="Bug" />&#160;Bugs:</a> 1 / 2</p><p class="nav"><a href="bugTrak.html#issues"><img src="../../../../../res/btIssue.png" width="16" height="16" alt="Issue" />&#160;Issues:</a> 0 / 0</p><p class="nav"><a href="bugTrak.html#questions"><img src="../../../../../res/btQuestion.png" width="16" height="16" alt="Question" />&#160;Questions:</a> 0 / 0</a></p><p class="nav">Updated:12 January 2004</p>
<br /><br /><img src="../../../../../res/updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="../../../../../res/update.png" width="8" height="8" alt="Update" />26 Jan 2003<br /><p class="update">Updated WM_CTLCOLOR.. processing so the control renders
correctly with an XP Manifest.</p><p class="update">Added missing mnubar.bmp to download.</p></p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="../../../../../res/related.png" width="125" height="21" alt="Related Items" />﻿<p class="nav"><img src="../../../../../res/rel.png" width="8" height="8" alt="Related Item" /><a href="http://www.vbaccelerator.com/article.asp?id=17">Subclassing Without The Crashes</a></p><p class="nav"><img src="../../../../../res/rel.png" width="8" height="8" alt="Related Item" /><a href="http://www.vbaccelerator.com/article.asp?id=1412">Owner Draw Combo and List Boxes Version 2.1</a></p><p class="nav"><img src="../../../../../res/rel.png" width="8" height="8" alt="Related Item" /><a href="http://www.vbaccelerator.com/article.asp?id=1025">Ole Guid and interface definitions (OleGuids.Tlb) </a></p><br /><br /><img src="../../../../../res/search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="http://www.google.com/search"><img src="../../../../../../../www.google.com/logos/Logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="http://www.vbaccelerator.com/home/The_Site/NewSite/article.asp"><img src="../../../../../res/newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: frmTest.frm</h1><pre>VERSION 5.00
Object = "{B6C8B132-5973-4983-AD46-8F3F10B04531}#1.0#0"; "vbalCbEx6.ocx"
Begin VB.Form frmComboExTest 
   Caption         =   "vbAccelerator ComboBoxEx Control Tester"
   ClientHeight    =   6825
   ClientLeft      =   3690
   ClientTop       =   1290
   ClientWidth     =   6240
   BeginProperty Font 
      Name            =   "Tahoma"
      Size            =   8.25
      Charset         =   0
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   Icon            =   "frmTest.frx":0000
   LinkTopic       =   "Form1"
   ScaleHeight     =   6825
   ScaleWidth      =   6240
   Begin vbalComboEx6.vbalCboEx cboSimple 
      Height          =   2730
      Left            =   3240
      TabIndex        =   18
      Top             =   4020
      Width           =   2835
      _ExtentX        =   5001
      _ExtentY        =   4815
      Style           =   1
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ExtendedUI      =   0   'False
      DropDownWidth   =   0
   End
   Begin vbalComboEx6.vbalCboEx cboColourPicker 
      Height          =   330
      Left            =   180
      TabIndex        =   17
      Top             =   4620
      Width           =   2895
      _ExtentX        =   5106
      _ExtentY        =   582
      Style           =   2
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ExtendedUI      =   0   'False
      DropDownWidth   =   0
      DrawStyle       =   5
   End
   Begin vbalComboEx6.vbalCboEx cboFonts 
      Height          =   330
      Left            =   180
      TabIndex        =   16
      Top             =   3960
      Width           =   2895
      _ExtentX        =   5106
      _ExtentY        =   582
      Style           =   2
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ExtendedUI      =   0   'False
      DropDownWidth   =   0
      DrawStyle       =   8
   End
   Begin vbalComboEx6.vbalCboEx vbalCboEx2 
      Height          =   330
      Left            =   180
      TabIndex        =   14
      Top             =   5520
      Width           =   2895
      _ExtentX        =   5106
      _ExtentY        =   582
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ExtendedUI      =   0   'False
      DropDownWidth   =   0
      AutoCompleteItemsAreSorted=   -1  'True
   End
   Begin vbalComboEx6.vbalCboEx vbalCboEx1 
      Height          =   330
      Left            =   120
      TabIndex        =   13
      Top             =   240
      Width           =   2835
      _ExtentX        =   5001
      _ExtentY        =   582
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ExtendedUI      =   0   'False
      DropDownWidth   =   0
      DrawStyle       =   9
   End
   Begin VB.CommandButton cmdInfo 
      Caption         =   "Info&gt;"
      Height          =   375
      Left            =   3060
      TabIndex        =   6
      Top             =   240
      Width           =   735
   End
   Begin VB.CheckBox chkDrawMode 
      Appearance      =   0  'Flat
      Caption         =   "&amp;Owner Draw"
      ForeColor       =   &amp;H80000008&amp;
      Height          =   195
      Left            =   120
      TabIndex        =   5
      Top             =   900
      Width           =   2835
   End
   Begin VB.CheckBox chkAutoComplete 
      Appearance      =   0  'Flat
      Caption         =   "&amp;Auto Complete"
      ForeColor       =   &amp;H80000008&amp;
      Height          =   255
      Left            =   120
      TabIndex        =   4
      Top             =   660
      Width           =   2835
   End
   Begin VB.CheckBox chkSorted 
      Appearance      =   0  'Flat
      Caption         =   "&amp;Sorted"
      ForeColor       =   &amp;H80000008&amp;
      Height          =   195
      Left            =   180
      TabIndex        =   2
      Top             =   5880
      Width           =   2175
   End
   Begin VB.ListBox lstInfo 
      Height          =   1620
      Left            =   3900
      TabIndex        =   1
      Top             =   240
      Width           =   2235
   End
   Begin VB.ListBox lstStatus 
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   1620
      Left            =   120
      TabIndex        =   0
      Top             =   2100
      Width           =   6015
   End
   Begin vbalComboEx6.vbalCboEx vbalCboEx3 
      Height          =   330
      Left            =   120
      TabIndex        =   15
      Top             =   1440
      Width           =   2835
      _ExtentX        =   5001
      _ExtentY        =   582
      Style           =   2
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ExtendedUI      =   0   'False
      DropDownWidth   =   0
      DrawStyle       =   9
   End
   Begin VB.Label lblInfo 
      Caption         =   "Same Control, but drop-down list style:"
      Height          =   195
      Index           =   6
      Left            =   120
      TabIndex        =   12
      Top             =   1200
      Width           =   5955
   End
   Begin VB.Label lblInfo 
      Caption         =   "Generic Auto Complete tester - nb can change Sorted
       property at Run Time!"
      Height          =   435
      Index           =   5
      Left            =   180
      TabIndex        =   11
      Top             =   5040
      Width           =   2835
   End
   Begin VB.Label lblInfo 
      Caption         =   "Colour Picker, drop-down list:"
      Height          =   195
      Index           =   4
      Left            =   180
      TabIndex        =   10
      Top             =   4380
      Width           =   2835
   End
   Begin VB.Label lblInfo 
      Caption         =   "Combo with Simple Style:"
      Height          =   195
      Index           =   3
      Left            =   3240
      TabIndex        =   9
      Top             =   3720
      Width           =   2835
   End
   Begin VB.Label lblInfo 
      Caption         =   "Font Picker, auto complete, ex UI"
      Height          =   195
      Index           =   2
      Left            =   180
      TabIndex        =   8
      Top             =   3720
      Width           =   2835
   End
   Begin VB.Label lblInfo 
      Caption         =   "Drive Picker:"
      Height          =   195
      Index           =   1
      Left            =   120
      TabIndex        =   7
      Top             =   0
      Width           =   5955
   End
   Begin VB.Label lblInfo 
      Caption         =   "Events:"
      Height          =   195
      Index           =   0
      Left            =   120
      TabIndex        =   3
      Top             =   1860
      Width           =   5955
   End
End
Attribute VB_Name = "frmComboExTest"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Const EM_GETSEL = &amp;HB0
Private Const EM_SETSEL = &amp;HB1
Private Declare Function SendMessage Lib "user32" Alias "SendMessageA" (ByVal
 hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long
Private Declare Function SendMessageLong Lib "user32" Alias "SendMessageA"
 (ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As
 Long) As Long
Private Declare Function SendMessageString Lib "user32" Alias "SendMessageA"
 (ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As
 String) As Long
Private m_cIml As New cVBALImageList

Private Sub Status(ByVal sMsg As String)
   lstStatus.AddItem sMsg
   lstStatus.ListIndex = lstStatus.NewIndex
End Sub
Private Sub Info()
   With vbalCboEx1
      lstInfo.Clear
      lstInfo.AddItem "MaxTextLength: " &amp; .MaxLength
      lstInfo.AddItem "ListCount: " &amp; .ListCount
      lstInfo.AddItem "ListIndex: " &amp; .ListIndex
      lstInfo.AddItem "Text: " &amp; .Text
      lstInfo.AddItem "SelStart: " &amp; .SelStart
      lstInfo.AddItem "SelLength: " &amp; .SelLength
      lstInfo.AddItem "List: " &amp; .List(.ListIndex)
      lstInfo.AddItem "Icon: " &amp; .ItemIcon(.ListIndex)
      lstInfo.AddItem "Indent: " &amp; .ItemIndent(.ListIndex)
   End With

End Sub

Private Sub chkAutoComplete_Click()
   vbalCboEx1.DoAutoComplete = (chkAutoComplete.Value = Checked)
End Sub

Private Sub chkDrawMode_Click()
   If chkDrawMode.Value = Checked Then
      vbalCboEx1.DrawStyle = eccxDrawODCboList
   Else
      vbalCboEx1.DrawStyle = eccxDrawDefault
   End If
End Sub

Private Sub chkSorted_Click()
   vbalCboEx2.Sorted = (chkSorted.Value = Checked)
End Sub

Private Sub cmdInfo_Click()
   Info
End Sub

Private Sub Form_Load()
Dim i As Long
Dim iIcon As Long
   
   For i = 1 To 100
      vbalCboEx2.AddItem "Test" &amp; i
   Next i
   
   m_cIml.IconSizeX = 16: m_cIml.IconSizeY = 16: m_cIml.ColourDepth =
    ILC_COLOR24
   m_cIml.Create
   m_cIml.AddFromFile App.Path &amp; "\mnubar.bmp", IMAGE_BITMAP
   cboSimple.ImageList = m_cIml.hIml
   For i = 1 To 100
      iIcon = i Mod m_cIml.ImageCount
      cboSimple.AddItemAndData "Test" &amp; i, iIcon
   Next i
   cboSimple.ListIndex = 0
   cboSimple.Move cboSimple.left, cboSimple.tOp, cboSimple.Width,
    cboSimple.Height
   
   
   ' Add the QB Colors:
   For i = 0 To 15
      cboColourPicker.AddItemAndData "QBColor:" &amp; i, , , QBColor(i)
   Next i
   
End Sub

Private Sub vbalCboEx1_AutoCompleteSelection(ByVal sItem As String, ByVal
 lIndex As Long)
   Status "AutoCompleteSelection:" &amp; sItem &amp; "," &amp; lIndex
End Sub

Private Sub vbalCboEx1_BeginEdit(ByVal iIndex As Long)
   Status "BeginEdit:" &amp; iIndex
End Sub

Private Sub vbalCboEx1_Change()
   Status "Change"
   Info
End Sub

Private Sub vbalCboEx1_Click()
   Status "Click"
   Info
End Sub

Private Sub vbalCboEx1_CloseUp()
   Status "CloseUp"
End Sub

Private Sub vbalCboEx1_DblClick()
   Status "DblClick"
End Sub

Private Sub vbalCboEx1_DragDrop(Source As Control, x As Single, y As Single)
   Status "DragDrop"
End Sub

Private Sub vbalCboEx1_DragOver(Source As Control, x As Single, y As Single,
 State As Integer)
   Status "DragOver"
End Sub

Private Sub vbalCboEx1_DropDown()
   Status "DropDown"
End Sub

Private Sub vbalCboEx1_EndEdit(ByVal iIndex As Long, ByVal bChanged As Boolean,
 ByVal sText As String, ByVal eWHy As ECCXEndEditReason, ByVal iNewIndex As
 Long)
   Status "EndEdit:" &amp; iIndex &amp; ",Changed:" &amp; bChanged &amp; ",Text:" &amp; sText &amp;
    ",Why=" &amp; eWHy &amp; ",iNewIndex = " &amp; iNewIndex
End Sub

Private Sub vbalCboEx1_GotFocus()
   Status "GotFocus"
End Sub

Private Sub vbalCboEx1_KeyDown(KeyCode As Integer, Shift As Integer)
   Status "KeyDown:" &amp; KeyCode &amp; "," &amp; Shift
End Sub

Private Sub vbalCboEx1_KeyPress(KeyAscii As Integer)
   Status "KeyPress:" &amp; KeyAscii
End Sub

Private Sub vbalCboEx1_KeyUp(KeyCode As Integer, Shift As Integer)
   Status "KeyUp:" &amp; KeyCode &amp; "," &amp; Shift
End Sub

Private Sub vbalCboEx1_LostFocus()
   Status "LostFocus"
End Sub

Private Sub vbalCboEx1_RequestDropDownResize(lLeft As Long, lTop As Long,
 lRight As Long, lBottom As Long, bCancel As Boolean)
   Status "RequestDropDownResize:" &amp; lLeft &amp; "," &amp; lTop &amp; "," &amp; lRight &amp; "," &amp;
    lBottom
End Sub

Private Sub vbalCboEx2_RequestDropDownResize(lLeft As Long, lTop As Long,
 lRight As Long, lBottom As Long, bCancel As Boolean)
   lRight = lLeft + vbalCboEx2.Width * 2 \ Screen.TwipsPerPixelX
   If lRight &gt; (Screen.Width \ Screen.TwipsPerPixelX) - 4 Then
      lLeft = lLeft - (lRight - Screen.Width \ Screen.TwipsPerPixelX) - 4
      lRight = (Screen.Width \ Screen.TwipsPerPixelX) - 4
   End If
End Sub
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center"></p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="http://www.vbaccelerator.com/home/index.asp"><img width="125" height="25" src="../../../../../res/vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="http://www.vbaccelerator.com/home/index.asp">Home</a>&#160;.&#160;<a href="../../../../index.html">VB</a>&#160;.&#160;<a href="../../../index.html">Code</a>&#160;.&#160;<a href="../../index.html">Controls</a>&#160;.&#160;<a href="../index.html">Combo and List Boxes</a>&#160;.&#160;<a href="article.html">vbAccelerator ComboBoxEx Control</a>&#160;.&#160;<a href="VB6_ComboBoxEx_Demonstration.html">VB6 ComboBoxEx Demonstration</a>&#160;.&#160;frmTest.frm</p><br /><p class="nav"><a href="http://www.vbaccelerator.com/home/The_Site/Copyright/article.asp">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 12 April 2003</p></td><td></td></tr></table>
</body>
<!-- Mirrored from www.vbaccelerator.com/home/VB/Code/Controls/Combo_and_List_Boxes/ComboBoxEx/VB6_ComboBoxEx_Demonstration_zip_frmTest_frm.asp by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Jun 2015 21:30:24 GMT -->
</html>