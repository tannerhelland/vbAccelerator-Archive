<html lang="en" >

<!-- Mirrored from www.vbaccelerator.com/home/VB/Code/Controls/Tab_Controls/vbAccelerator_ComCtl32_Tab_Control/VB6_TabStrip_Control_Demonstration_zip_fTabTest_frm.asp by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Jun 2015 21:30:53 GMT -->
<head>
<title>vbAccelerator - Contents of code file: fTabTest.frm</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: fTabTest.frm" /><link rel="stylesheet" href="../../../../../res/screen.css" media="SCREEN" /><link rel="stylesheet" href="../../../../../res/print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000.html";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="../../../../../../../pagead2.googlesyndication.com/pagead/f.txt">
</script>
</p>
</td>
<td></td>
</tr></tr><tr class="navbar"><td><a href="http://www.vbaccelerator.com/home/index.asp"><img width="125" height="25" src="../../../../../res/vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="http://www.vbaccelerator.com/home/index.asp">Home</a>&#160;.&#160;<a href="../../../../index.html">VB</a>&#160;.&#160;<a href="../../../index.html">Code</a>&#160;.&#160;<a href="../../index.html">Controls</a>&#160;.&#160;<a href="../index.html">Tab Controls</a>&#160;.&#160;<a href="article.html">vbAccelerator TabStrip Control</a>&#160;.&#160;<a href="VB6_TabStrip_Control_Demonstration.html">VB6 TabStrip Control Demonstration</a>&#160;.&#160;fTabTest.frm</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="../../../../../res/download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="VB5_TabStrip_Control_Binary.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB5 TabStrip Control Binary</a> (19K)</p><p class="nav"><a href="VB5_TabStrip_Control_Demonstration.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB5 TabStrip Control Demonstration</a> (18K)</p><p class="nav"><a href="VB5_TabStrip_Control_Full_Source.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB5 TabStrip Control Full Source</a> (57K)</p><p /><p class="nav"><a href="VB6_TabStrip_Control_Binary.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB6 TabStrip Control Binary</a> (20K)</p><p class="nav"><a href="VB6_TabStrip_Control_Demonstration.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB6 TabStrip Control Demonstration</a> (16K)</p><p class="nav"><a href="VB6_TabStrip_Control_Full_Source.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB6 TabStrip Control Full Source</a> (57K)</p><p /><p class="nav"><a href="vbalTabStrip_Interface_Definition.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />vbalTabStrip Interface Definition</a> (2K)</p><br /><br /><img src="../../../../../res/information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:2801</p><p class="nav">&#160;&#160;<a href="http://www.vbaccelerator.com/linkto.asp?id=2801&amp;type=Zip&amp;title=VB6%20TabStrip%20Control%20Demonstration%2Ezip%5FfTabTest">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="../../../../../res/bugTrak.png" width="125" height="21" alt="BugTrak System" />﻿<p class="nav"><a href="bugTrak.html">BugTrak</a></p><p class="nav"><a href="bugTrak.html#bugs"><img src="../../../../../res/btBug.png" width="16" height="16" alt="Bug" />&#160;Bugs:</a> 1 / 1</p><p class="nav"><a href="bugTrak.html#issues"><img src="../../../../../res/btIssue.png" width="16" height="16" alt="Issue" />&#160;Issues:</a> 2 / 2</p><p class="nav"><a href="bugTrak.html#questions"><img src="../../../../../res/btQuestion.png" width="16" height="16" alt="Question" />&#160;Questions:</a> 0 / 0</a></p><p class="nav">Updated:23 October 2003</p>
<br /><br /><img src="../../../../../res/updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="../../../../../res/update.png" width="8" height="8" alt="Update" />7 Jan 2003<br /><p class="updated">Added XP Visual Styles Manifest</p></p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="../../../../../res/related.png" width="125" height="21" alt="Related Items" />﻿<p class="nav"><img src="../../../../../res/rel.png" width="8" height="8" alt="Related Item" /><a href="http://www.vbaccelerator.com/article.asp?id=1025">Ole Guid and interface definitions (OleGuids.Tlb) </a></p><p class="nav"><img src="../../../../../res/rel.png" width="8" height="8" alt="Related Item" /><a href="http://www.vbaccelerator.com/article.asp?id=1427">Adding XP Visual Styles to Your Visual Basic Application</a></p><p class="nav"><img src="../../../../../res/rel.png" width="8" height="8" alt="Related Item" /><a href="http://www.vbaccelerator.com/article.asp?id=17">Subclassing Without The Crashes</a></p><p class="nav"><img src="../../../../../res/rel.png" width="8" height="8" alt="Related Item" /><a href="http://www.vbaccelerator.com/article.asp?id=2">vbAccelerator ImageList Control and Class v2.0</a></p><br /><br /><img src="../../../../../res/search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="http://www.google.com/search"><img src="../../../../../../../www.google.com/logos/Logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="http://www.vbaccelerator.com/home/The_Site/NewSite/article.asp"><img src="../../../../../res/newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: fTabTest.frm</h1><pre>VERSION 5.00
Object = "{396F7AC0-A0DD-11D3-93EC-00C0DFE7442A}#1.0#0"; "vbalIml6.ocx"
Object = "{5F37140E-C836-11D2-BEF8-525400DFB47A}#1.1#0"; "vbalTab6.ocx"
Begin VB.Form frmTabTest 
   Caption         =   "vbAccelerator TabStrip Control Tester"
   ClientHeight    =   5325
   ClientLeft      =   2430
   ClientTop       =   1860
   ClientWidth     =   6525
   BeginProperty Font 
      Name            =   "Tahoma"
      Size            =   8.25
      Charset         =   0
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   Icon            =   "fTabTest.frx":0000
   LinkTopic       =   "Form1"
   ScaleHeight     =   5325
   ScaleWidth      =   6525
   Begin VB.PictureBox picTestCtrl 
      Height          =   4095
      Left            =   1020
      ScaleHeight     =   4035
      ScaleWidth      =   3915
      TabIndex        =   2
      TabStop         =   0   'False
      Top             =   600
      Visible         =   0   'False
      Width           =   3975
      Begin VB.Frame fraStyle 
         Caption         =   "&amp;Style"
         Height          =   3195
         Left            =   60
         TabIndex        =   7
         Top             =   780
         Width           =   3795
         Begin VB.PictureBox picOptHolder 
            BorderStyle     =   0  'None
            Height          =   2895
            Left            =   60
            ScaleHeight     =   2895
            ScaleWidth      =   3675
            TabIndex        =   9
            Top             =   180
            Width           =   3675
            Begin VB.CheckBox chkOwnerDraw 
               Appearance      =   0  'Flat
               Caption         =   "&amp;Owner Draw"
               ForeColor       =   &amp;H80000008&amp;
               Height          =   315
               Left            =   0
               TabIndex        =   20
               Top             =   1320
               Width           =   1215
            End
            Begin VB.CommandButton cmdRebuild 
               Caption         =   "&amp;Rebuild it..."
               Height          =   375
               Left            =   2340
               TabIndex        =   19
               Top             =   0
               Width           =   1215
            End
            Begin VB.ComboBox cboAlign 
               Height          =   315
               Left            =   540
               Style           =   2  'Dropdown List
               TabIndex        =   18
               Top             =   2580
               Width           =   1575
            End
            Begin VB.CheckBox chkFlatButtons 
               Appearance      =   0  'Flat
               Caption         =   "&amp;Flat Buttons"
               Enabled         =   0   'False
               ForeColor       =   &amp;H80000008&amp;
               Height          =   255
               Left            =   240
               TabIndex        =   17
               Top             =   780
               Width           =   1455
            End
            Begin VB.CheckBox chkFlatSeparators 
               Appearance      =   0  'Flat
               Caption         =   "&amp;Flat Separators"
               Enabled         =   0   'False
               ForeColor       =   &amp;H80000008&amp;
               Height          =   255
               Left            =   240
               TabIndex        =   16
               Top             =   540
               Width           =   1455
            End
            Begin VB.CheckBox chkHotTrack 
               Appearance      =   0  'Flat
               Caption         =   "&amp;Hot Track"
               ForeColor       =   &amp;H80000008&amp;
               Height          =   255
               Left            =   0
               TabIndex        =   15
               Top             =   1080
               Width           =   2955
            End
            Begin VB.CheckBox chkButtons 
               Appearance      =   0  'Flat
               Caption         =   "&amp;Buttons"
               ForeColor       =   &amp;H80000008&amp;
               Height          =   255
               Left            =   0
               TabIndex        =   14
               Top             =   300
               Width           =   1155
            End
            Begin VB.CheckBox chkMultiLine 
               Appearance      =   0  'Flat
               Caption         =   "&amp;Multi Line"
               ForeColor       =   &amp;H80000008&amp;
               Height          =   255
               Left            =   0
               TabIndex        =   13
               Top             =   60
               Width           =   1095
            End
            Begin VB.OptionButton optStyle 
               Appearance      =   0  'Flat
               Caption         =   "&amp;Standard"
               ForeColor       =   &amp;H80000008&amp;
               Height          =   255
               Index           =   0
               Left            =   240
               TabIndex        =   12
               Top             =   1620
               Width           =   2295
            End
            Begin VB.OptionButton optStyle 
               Appearance      =   0  'Flat
               Caption         =   "&amp;Flat"
               ForeColor       =   &amp;H80000008&amp;
               Height          =   255
               Index           =   1
               Left            =   240
               TabIndex        =   11
               Top             =   1860
               Width           =   2295
            End
            Begin VB.OptionButton optStyle 
               Appearance      =   0  'Flat
               Caption         =   "&amp;DevStudio"
               ForeColor       =   &amp;H80000008&amp;
               Height          =   255
               Index           =   2
               Left            =   240
               TabIndex        =   10
               Top             =   2100
               Width           =   2295
            End
            Begin VB.Label lblAlign 
               Caption         =   "Align:"
               Height          =   195
               Left            =   0
               TabIndex        =   21
               Top             =   2640
               Width           =   495
            End
         End
      End
      Begin VB.CommandButton cmdRemoveAll 
         Caption         =   "Remove A&amp;ll"
         Height          =   315
         Left            =   1200
         TabIndex        =   6
         Top             =   420
         Width           =   1095
      End
      Begin VB.CommandButton cmdRemoveTab 
         Caption         =   "&amp;Remove Tab"
         Height          =   315
         Left            =   1200
         TabIndex        =   5
         Top             =   60
         Width           =   1095
      End
      Begin VB.CommandButton cmdAddTab 
         Caption         =   "&amp;Add Tab"
         Height          =   315
         Left            =   60
         TabIndex        =   4
         Top             =   60
         Width           =   1095
      End
      Begin VB.CommandButton cmdInsertTab 
         Caption         =   "&amp;Insert Tab"
         Height          =   315
         Left            =   60
         TabIndex        =   3
         Top             =   420
         Width           =   1095
      End
   End
   Begin vbalIml6.vbalImageList ilsIcons 
      Left            =   240
      Top             =   3960
      _ExtentX        =   953
      _ExtentY        =   953
      ColourDepth     =   24
      Size            =   5640
      Images          =   "fTabTest.frx":0442
      KeyCount        =   6
      Keys            =   ""
   End
   Begin VB.PictureBox picTab 
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   735
      Left            =   900
      ScaleHeight     =   675
      ScaleWidth      =   975
      TabIndex        =   0
      Top             =   3900
      Width           =   1035
      Begin VB.ListBox lstInfo 
         Height          =   450
         IntegralHeight  =   0   'False
         Left            =   60
         TabIndex        =   1
         Top             =   60
         Width           =   915
      End
   End
   Begin vbalTabStrip6.TabControl tabTest 
      Height          =   3795
      Left            =   60
      TabIndex        =   8
      Top             =   60
      Width           =   6315
      _ExtentX        =   11139
      _ExtentY        =   6694
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
End
Attribute VB_Name = "frmTabTest"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Sub pShowOptions()
   With tabTest
      chkMultiLine.Value = Abs(.MultiLine)
      chkButtons.Value = Abs(.Buttons)
      chkFlatSeparators.Value = Abs(.FlatSeparators And .Buttons)
      chkFlatButtons.Value = Abs(.FlatButtons And .Buttons)
      chkHotTrack.Value = Abs(.HotTrack)
      cboAlign.ListIndex = .TabAlign
   End With
End Sub

Private Sub chkButtons_Click()
Dim bS As Boolean
   bS = (chkButtons.Value = Checked)
   chkFlatSeparators.Enabled = bS
   chkFlatButtons.Enabled = bS
End Sub

Private Sub cmdAddTab_Click()
Dim sText As String
   sText = "Test" &amp; CLng(Rnd * 100 + 1)
   tabTest.AddTab sText, Rnd * ilsIcons.ImageCount - 1, , sText
   If tabTest.TabCount = 1 Or tabTest.MultiLine Then
      Form_Resize
   End If
End Sub

Private Sub cmdInsertTab_Click()
On Error GoTo ErrorHandler
Dim lIndex As Long
Dim sI As String
Dim sText As String

   sI = InputBox$("Insert Before Which Tab? (Enter 1 based index or key)", ,
    tabTest.TabKey(tabTest.SelectedTab))
   If (sI &lt;&gt; "") Then
      sText = "Test" &amp; CLng(Rnd * 100 + 1)
      tabTest.AddTab sText, Rnd * ilsIcons.ImageCount, sI, sText
      If tabTest.MultiLine Then
         Form_Resize
      End If
   End If
   Exit Sub
ErrorHandler:
   MsgBox Err.Description, vbExclamation
   Exit Sub
End Sub

Private Sub cmdRebuild_Click()
   With tabTest
      .Buttons = (chkButtons.Value = Checked)
      If (.Buttons) Then
         .FlatButtons = (chkFlatButtons.Value = Checked)
         .FlatSeparators = (chkFlatSeparators.Value = Checked)
      End If
      .MultiLine = (chkMultiLine.Value = Checked)
      .HotTrack = (chkHotTrack.Value = Checked)
      .TabAlign = cboAlign.ListIndex
      .OwnerDraw = (chkOwnerDraw.Value = Checked)
      
      .Rebuild
      
      Form_Resize
      
      pShowOptions
   End With
End Sub

Private Sub cmdRemoveAll_Click()
   If (vbYes = MsgBox("Are you sure you want to remove all tabs?", vbYesNo Or
    vbQuestion)) Then
      tabTest.RemoveAllTabs
      If tabTest.TabCount = 0 Then
         Form_Resize
      End If
   End If
End Sub

Private Sub cmdRemoveTab_Click()
On Error GoTo ErrorHandler
Dim sI As String

   sI = InputBox$("Which Tab?", , tabTest.TabKey(tabTest.SelectedTab))
   If (sI &lt;&gt; "") Then
      tabTest.RemoveTab sI
      If tabTest.TabCount = 0 Then
         Form_Resize
      End If
   End If
   Exit Sub
ErrorHandler:
   MsgBox Err.Description, vbExclamation
   Exit Sub

End Sub

Private Sub Form_Load()
Dim i As Long
   
   With cboAlign
      .AddItem "Top"
      .AddItem "Left"
      .AddItem "Bottom"
      .AddItem "Right"
      .ListIndex = 0
   End With

   picTab.BorderStyle = 0
   picTestCtrl.BorderStyle = 0
   With tabTest
     .ImageList = ilsIcons
      .AddTab "Editor", 0, , "EDITOR", 1000
      .AddTab "Editor Format", 1, , "FORMAT", 2000
      .AddTab "General", 2, , "GENERAL", 3000
      .AddTab "Docking", 3, , "DOCKING", 4000
      .AddTab "Environment", 4, , "ENVIRONMENT", 5000
      .AddTab "Advanced", 5, , "ADVANCED", 6000
   End With
   
   pShowOptions
   
End Sub

Private Sub Form_Resize()
   On Error Resume Next
   With tabTest
      .Move tabTest.Left, tabTest.Top, Me.ScaleWidth - tabTest.Left * 2,
       Me.ScaleHeight - tabTest.Top * 2
      picTab.Move .ClientLeft, .ClientTop, .ClientWidth, .ClientHeight
      picTestCtrl.Move .ClientLeft, .ClientTop, .ClientWidth, .ClientHeight
   End With
End Sub

Private Sub optStyle_Click(Index As Integer)
   Select Case True
   Case optStyle(0).Value
      tabTest.CoolTabs = etaNone
      Me.BackColor = vbButtonFace
   Case optStyle(1).Value
      tabTest.CoolTabs = etaThinBlockEdge
      Me.BackColor = vbButtonFace
   Case optStyle(2).Value
      tabTest.CoolTabs = etaDevStudio
      Me.BackColor = vbButtonFace 'vbButtonShadow
   End Select
End Sub

Private Sub picTab_Resize()
On Error Resume Next
   lstInfo.Move 0, 0, picTab.ScaleWidth, picTab.ScaleHeight
End Sub

Private Sub tabTest_BeforeClick(ByVal lTab As Long, bCancel As Boolean)
    Debug.Print "BeforeClick:" &amp; lTab
    lstInfo.AddItem "Tab_BeforeClick:" &amp; lTab &amp; " " &amp; TabInfo(lTab)
End Sub

Private Sub tabTest_DrawItem(ByVal lTab As Long, ByVal hdc As Long, ByVal
 bSelected As Boolean, ByVal bHot As Boolean, LeftPixels As Long, TopPixels As
 Long, RightPixels As Long, BottomPixels As Long, bDoDefault As Boolean)
   bDoDefault = True
End Sub

Private Sub tabTest_GotFocus()
   lstInfo.AddItem "GotFocus"
End Sub

Private Sub tabTest_LostFocus()
   lstInfo.AddItem "LostFocus"
End Sub

Private Sub tabTest_TabClick(ByVal lTab As Long)
   Debug.Print "TabClick:" &amp; lTab
   lstInfo.AddItem "Tab_Click:" &amp; lTab &amp; " " &amp; TabInfo(lTab)
   picTab.Visible = ((lTab Mod 2) = 1)
   picTestCtrl.Visible = Not (picTab.Visible)
End Sub

Private Sub tabTest_TabRightClick()
   lstInfo.AddItem "TabRightClick"
End Sub
Private Function TabInfo(ByVal lTab As Long) As String
   TabInfo = " (Text: '" &amp; tabTest.TabText(lTab) &amp; "', Image: " &amp;
    tabTest.TabImage(lTab) &amp; ", Key: " &amp; tabTest.TabKey(lTab) &amp; ", ItemData: "
    &amp; tabTest.TabItemData(lTab) &amp; ")"
End Function
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center"></p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="http://www.vbaccelerator.com/home/index.asp"><img width="125" height="25" src="../../../../../res/vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="http://www.vbaccelerator.com/home/index.asp">Home</a>&#160;.&#160;<a href="../../../../index.html">VB</a>&#160;.&#160;<a href="../../../index.html">Code</a>&#160;.&#160;<a href="../../index.html">Controls</a>&#160;.&#160;<a href="../index.html">Tab Controls</a>&#160;.&#160;<a href="article.html">vbAccelerator TabStrip Control</a>&#160;.&#160;<a href="VB6_TabStrip_Control_Demonstration.html">VB6 TabStrip Control Demonstration</a>&#160;.&#160;fTabTest.frm</p><br /><p class="nav"><a href="http://www.vbaccelerator.com/home/The_Site/Copyright/article.asp">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 12 April 2003</p></td><td></td></tr></table>
</body>
<!-- Mirrored from www.vbaccelerator.com/home/VB/Code/Controls/Tab_Controls/vbAccelerator_ComCtl32_Tab_Control/VB6_TabStrip_Control_Demonstration_zip_fTabTest_frm.asp by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Jun 2015 21:30:53 GMT -->
</html>